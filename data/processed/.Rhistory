#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size = 10, color = "black"),
strip.text = element_text(size = 11),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, rgr13 = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, rgr13, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, rgr13),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = rgr13), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 0.0028) +
scale_y_continuous(limits = c(0.0003,0.0028), breaks = seq(-100,100,0.0005)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(paste("Relative growth rate (RGR)")), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_rgr_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure root tissue density  ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
edata <- select(edata, rtd, plot, block, species, brickRatio, soilType, mycorrhiza, conf.low, conf.high)
#Exclude 2 outlier
edata <- filter(edata, rtd < 1000 & rtd > -80)
#### Chosen model ###
m4 <- lmer(log(rtd) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size = 10, color = "black"),
strip.text = element_text(size = 11),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, rtd = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, rtd, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, rtd),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = rtd), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 9.5) +
scale_y_continuous(limits = c(1.5,9.5), breaks = seq(-100,150,1)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(Root~tissue~density~(SRL[1-3])*~"["*g~cm^-3*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_rtd_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure root tissue density  ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
edata <- select(edata, rtd, plot, block, species, brickRatio, soilType, mycorrhiza, conf.low, conf.high)
#Exclude 2 outlier
edata <- filter(edata, rtd < 1000 & rtd > -80)
#### Chosen model ###
m4 <- lmer(log(rtd) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size = 10, color = "black"),
strip.text = element_text(size = 11),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, rtd = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, rtd, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, rtd),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = rtd), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 9.5) +
scale_y_continuous(limits = c(1.5,9.5), breaks = seq(-100,150,1)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(Root~tissue~density~(RTD[1-3])*~"["*g~cm^-3*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_rtd_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure specific leaf area  ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
edata <- gather(edata, "leaf", "sla", sla1, sla2, sla3, factor_key = T)
(edata <- select(edata, leaf, sla, plot, block, species, brickRatio, soilType, mycorrhiza, conf.low, conf.high))
#### Chosen model ###
m4 <- lmer(log(sla) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block/plot), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size=10, color = "black"),
strip.text = element_text(size = 11),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, sla, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 270) +
scale_y_continuous(limits = c(120,270), breaks = seq(-100,270,50)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(Specific~leaf~area~"("*SLA*")"~"["*cm^2~g^-1*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_sla_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure root-shoot ratio  ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
edata <- select(edata, rootshootRatio, plot, block, species, brickRatio, soilType, mycorrhiza, conf.low, conf.high)
#### Chosen model ###
m4 <- lmer(log(rootshootRatio) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size = 10, color = "black"),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, rootshootRatio = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, rootshootRatio, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, rootshootRatio),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = rootshootRatio), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 2.06) +
scale_y_continuous(limits = c(0.5,2.06), breaks = seq(-100,100,0.2)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression("Root-to-shoot ratio ["*g~g^-1*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_rootshootRatio_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure specific root length  ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
(edata <- select(edata, srl, plot, block, species, brickRatio, soilType, mycorrhiza, conf.low, conf.high))
#Exclude 2 outlier
edata <- filter(edata, srl > -1000)
#### Chosen model ###
m4 <- lmer(log(srl) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size=10, color = "black"),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, srl = predicted, soilType = x, brickRatio = group, species = facet)
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, srl, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, srl),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = srl), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 150) +
scale_y_continuous(limits = c(0,150), breaks = seq(-100,150,20)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(Specific~root~length~(SRL[1-3])*~"["*m~g^-1*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_srl_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
# Show Figure absorptive vs. transportive fine-root ratio ~ soilType:species:brickRatio ####
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# A Preparation ################################################################################################################
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
### Packages ###
library(tidyverse)
library(ggbeeswarm)
library(lme4)
library(emmeans)
library(ggeffects)
### Start ###
rm(list = ls())
setwd("Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/data/processed")
### Load data ###
edata <- read_table2("data_processed_brickRatio.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(levels = c("Control","Mycorrhiza")),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(),
acidbrickRatioTreat = col_factor()
)
)
(edata <- select(edata, abstransRatio, plot, block, species, brickRatio, soilType, mycorrhiza, conf.high, conf.low))
#Exclude 1 outlier
edata <- filter(edata, abstransRatio < 6)
#### Chosen model ###
m4 <- lmer(log(abstransRatio+1) ~ (species + brickRatio + soilType + mycorrhiza)^2 +
species:brickRatio:soilType + species:brickRatio:mycorrhiza +
(1|block), edata, REML = F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size = 10, color = "black"),
axis.title.y = element_text(size = 9),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
axis.text.y = element_text(angle = 90, hjust = 0.5),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 10),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### acid:soilType ###
pdata <- ggemmeans(m4, terms = c("soilType","brickRatio", "species"), type = "fe")
pdata <- rename(pdata, abstransRatio = predicted, soilType = x, brickRatio = group, species = facet)
pdata$abstransRatio <- pdata$abstransRatio-1
pdata$conf.low <- pdata$conf.low-1
pdata$conf.high <- pdata$conf.high-1
meandata <- filter(pdata, soilType == "poor" & brickRatio == "5")
pd <- position_dodge(.6)
ggplot(pdata, aes(soilType, abstransRatio, shape = brickRatio, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(soilType, abstransRatio),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = abstransRatio), meandata,
color = "grey70", size = .25) +
geom_hline(aes(yintercept = conf.low), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_hline(aes(yintercept = conf.high), meandata,
color = "grey70", linetype = "dashed", size = .25) +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
annotate("text", label = "n.s.", x = 2.2, y = 2.2) +
scale_y_continuous(limits = c(-0.02,2.2), breaks = seq(-100,100,0.5)) +
scale_shape_manual(values = c(1,16)) +
labs(x = "Soil fertility", y = expression(Absorptive*":"*transport~fine~roots~"["*g~g^-1*"]"), shape = "Brick ratio [%]", color = "") +
themeMB()
ggsave("figure_soilType_abstransRatio_(800dpi_12x7cm).tiff",
dpi = 800, width = 12, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
