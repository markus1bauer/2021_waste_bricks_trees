date1 = col_date(),
date2 = col_date(),
date3 = col_date(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(levels = c("Control","Acid")),
acidbrickRatioTreat = col_factor(levels = c("Control_30","Acid_5","Acid_30"))
)
))
edata <- gather(edata, "leaf", "sla", sla1, sla2, sla3, factor_key = T)
edata <- select(edata, leaf, sla, plot, block, replanted, species, acid, brickRatio, acidbrickRatioTreat, soilType, conf.high, conf.low)
edata$acidbrickRatioTreat <- dplyr::recode(edata$acidbrickRatioTreat,
"Control_30" = "Control 30% bricks", "Acid_5" = "Acid 5% bricks", "Acid_30" = "Acid 30% bricks")
#### Chosen model ###
m2 <- lmer((sla) ~ species * soilType * acidbrickRatioTreat +
(1|block/plot), edata, REML= F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size=10, color = "black"),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### interaction: acid x brickRatio x species ###
pdata <- ggemmeans(m2, terms = c("acidbrickRatioTreat", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, acidbrickRatioTreat = x, species = group)
meandata <- filter(pdata, acidbrickRatioTreat == "Control 30% bricks")
pd <- position_dodge(.6)
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor(Tilia, levels = c("Acer","Tilia"))),
label = "ab")
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor(Tilia, levels = c("Acer","Tilia"))),
label = "ab") +
geom_text(data = ann_text, label = "a")
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor(Tilia, levels = c("Acer","Tilia"))),
label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia"))),
label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
### Load data ###
(edata <- read_table2("data_processed_acid.txt", col_names = T, na = "na", col_types =
cols(
.default = col_double(),
plot = col_factor(),
block = col_factor(),
date1 = col_date(),
date2 = col_date(),
date3 = col_date(),
replanted = col_factor(),
species = col_factor(),
mycorrhiza = col_factor(),
substrate = col_factor(),
soilType = col_factor(levels = c("poor","rich")),
brickRatio = col_factor(levels = c("5","30")),
acid = col_factor(levels = c("Control","Acid")),
acidbrickRatioTreat = col_factor(levels = c("Control_30","Acid_5","Acid_30"))
)
))
edata <- gather(edata, "leaf", "sla", sla1, sla2, sla3, factor_key = T)
edata <- select(edata, leaf, sla, plot, block, replanted, species, acidbrickRatioTreat, soilType, conf.high, conf.low)
edata$acidbrickRatioTreat <- dplyr::recode(edata$acidbrickRatioTreat,
"Control_30" = "Control 30% bricks", "Acid_5" = "Acid 5% bricks", "Acid_30" = "Acid 30% bricks")
#### Chosen model ###
m2 <- lmer((sla) ~ species * soilType * acidbrickRatioTreat +
(1|block/plot), edata, REML= F)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# B Plotten ################################################################################################################
#+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
themeMB <- function(){
theme(
panel.background = element_rect(fill = "white"),
text  = element_text(size=10, color = "black"),
axis.line.y = element_line(),
axis.line.x = element_blank(),
axis.ticks.x = element_blank(),
legend.key = element_rect(fill = "white"),
legend.position = "right",
legend.margin = margin(0, 0, 0, 0, "cm"),
plot.margin = margin(0, 0, 0, 0, "cm")
)
}
### interaction: acid x brickRatio x species ###
pdata <- ggemmeans(m2, terms = c("acidbrickRatioTreat", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, acidbrickRatioTreat = x, species = group)
meandata <- filter(pdata, acidbrickRatioTreat == "Control 30% bricks")
pd <- position_dodge(.6)
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia"))),
label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = pdata$conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia"))),
label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia"))),
label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
#geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
#                           species = factor("Tilia", levels = c("Acer","Tilia"))),
#        label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
a <- ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
#geom_text(data = data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
#                           species = factor("Tilia", levels = c("Acer","Tilia"))),
#        label = "ab") +
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")))
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 0.6)
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 0.6, conf.high = 0.7)
#geom_text(data = ann_text, label = "a")
#geom_text(data = ann_text, label = "b")
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 0.7, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 0.6, conf.high = 0.7)
a + geom_text(data = ann_text, label = "Text")
a
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 280, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 0.6, conf.high = 0.7)
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 280, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 280, conf.high = 280)
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 280, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 279, conf.high = 280)
a + geom_text(data = ann_text, label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 280, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")), conf.low = 270, conf.high = 280)
a + geom_text(data = ann_text, label = "Text")
View(ann_text)
ann_text <- data.frame(acidbrickRatioTreat = "Acid_30", sla = 280, lab = "Text",
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 270,
conf.high = 280,
std.error = 4.75)
a + geom_text(data = ann_text, label = "Text")
rel_pos <- function(.data, var, rel){
var <- enquo(var)
.data %>%
summarise(x = sum(max(!!var), min(!!var))* rel) %>% .[1, "x"]
}
my_text <- data_frame(acidbrickRatioTreat = rel_pos(edata, acidbrickRatioTreat, "Acid 30% bricks"),
sla = rel_pos(edata, sla, 280) ,
species = "Tilia",
lab = "text")
rel_pos <- function(.data, var, rel){
var <- enquo(var)
.data %>%
summarise(x = sum(max(!!var), min(!!var))* rel) %>% .[1, "x"]
}
my_text <- data_frame(acidbrickRatioTreat = rel_pos(edata, acidbrickRatioTreat, "Acid 30% bricks"),
sla = rel_pos(edata, sla, 280) ,
species = "Tilia",
lab = "text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
cyl = factor("Tilia", levels = c("Acer","Tilia"))
lab = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
cyl = factor("Tilia", levels = c("Acer","Tilia")),
lab = "Text")
a + geom_text(data = ann_text,label = "Text")
a <- ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ann_text <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
cyl = factor("Tilia", levels = c("Acer","Tilia")),
lab = "Text")
a + geom_text(data = ann_text,label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
cyl = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280,
lab = "Text")
a + geom_text(data = ann_text,label = "Text")
ann_text <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280,
lab = "Text")
a + geom_text(data = ann_text,label = "Text")
ann_text1 <- data.frame(acidbrickRatioTreat = "Control 30% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280,
lab = "ab")
ann_text2 <- data.frame(acidbrickRatioTreat = "Acid 5% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280,
lab = "ab")
ann_text3 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280,
lab = "ab")
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "Text") +
geom_text(data = ann_text2, label = "Text") +
geom_text(data = ann_text3, label = "Text") +
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "ab") +
geom_text(data = ann_text2, label = "a") +
geom_text(data = ann_text3, label = "b") +
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
pdata <- ggemmeans(m2, terms = c("acidbrickRatioTreat", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, acidbrickRatioTreat = x, species = group)
meandata <- filter(pdata, acidbrickRatioTreat == "Control 30% bricks")
pd <- position_dodge(.6)
ann_text1 <- data.frame(acidbrickRatioTreat = "Control 30% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text2 <- data.frame(acidbrickRatioTreat = "Acid 5% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text3 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "ab") +
geom_text(data = ann_text2, label = "a") +
geom_text(data = ann_text3, label = "b") +
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
pdata <- ggemmeans(m2, terms = c("acidbrickRatioTreat", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, acidbrickRatioTreat = x, species = group)
meandata <- filter(pdata, acidbrickRatioTreat == "Control 30% bricks")
pd <- position_dodge(.6)
ann_text1 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 290,
species = factor("Acer", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text2 <- data.frame(acidbrickRatioTreat = "Control 30% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text3 <- data.frame(acidbrickRatioTreat = "Acid 5% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text4 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 290,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "n.s.") +
geom_text(data = ann_text2, label = "ab") +
geom_text(data = ann_text3, label = "a") +
geom_text(data = ann_text4, label = "b") +
scale_y_continuous(limits = c(110,290), breaks = seq(-100,380,20)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggsave("figure_acid_sla_(800dpi_8x7cm).tiff",
dpi = 800, width = 8, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
pdata <- ggemmeans(m2, terms = c("acidbrickRatioTreat", "species"), type = "fe")
pdata <- rename(pdata, sla = predicted, acidbrickRatioTreat = x, species = group)
meandata <- filter(pdata, acidbrickRatioTreat == "Control 30% bricks")
pd <- position_dodge(.6)
ann_text1 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
species = factor("Acer", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text2 <- data.frame(acidbrickRatioTreat = "Control 30% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text3 <- data.frame(acidbrickRatioTreat = "Acid 5% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ann_text4 <- data.frame(acidbrickRatioTreat = "Acid 30% bricks",
sla = 280,
species = factor("Tilia", levels = c("Acer","Tilia")),
conf.low = 280,
conf.high = 280)
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "n.s.") +
geom_text(data = ann_text2, label = "ab") +
geom_text(data = ann_text3, label = "a") +
geom_text(data = ann_text4, label = "b") +
scale_y_continuous(limits = c(110,280), breaks = seq(-100,380,50)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggsave("figure_acid_sla_(800dpi_8.5x7cm).tiff",
dpi = 800, width = 8.5, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
ggplot(pdata, aes(acidbrickRatioTreat, sla, shape = acidbrickRatioTreat, ymin = conf.low, ymax = conf.high))+
geom_quasirandom(data = edata, aes(acidbrickRatioTreat, sla),
color = "grey70", dodge.width = .6, size = 0.7)+
geom_hline(aes(yintercept = sla), meandata, color = "grey70") +
geom_errorbar(position = pd, width = 0.0, size = 0.4) +
geom_point(position = pd, size = 2.5) +
facet_grid(~ species) +
geom_text(data = ann_text1, label = "n.s.") +
geom_text(data = ann_text2, label = "ab") +
geom_text(data = ann_text3, label = "a") +
geom_text(data = ann_text4, label = "b") +
scale_y_continuous(limits = c(110,280), breaks = seq(-100,380,25)) +
scale_shape_manual(values = c(1,16,16)) +
labs(x = "", y = expression(Specific~leaf~area~"("*SLA*")"~"["*mg~mm^-2*"]"), shape = "", color = "") +
guides(x = guide_axis(angle = 45), shape = F)+
themeMB()
ggsave("figure_acid_sla_(800dpi_10x7cm).tiff",
dpi = 800, width = 10, height = 7, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
ggsave("figure_acid_sla_(800dpi_8x8cm).tiff",
dpi = 800, width = 8, height = 8, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
ggsave("figure_acid_sla_(800dpi_8x7.5cm).tiff",
dpi = 800, width = 8, height = 7.5, units = "cm", path = "Z:/Documents/0_Ziegelprojekt/3_Aufnahmen_und_Ergebnisse/2020_waste_bricks_trees/outputs/figures")
